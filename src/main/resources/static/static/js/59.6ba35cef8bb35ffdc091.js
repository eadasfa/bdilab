webpackJsonp([59],{COFt:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=t("ZoQJ"),l={startDate:null,endDate:null,restaurantNo:null,restaurantName:null,operateType:null,restaurantAddress:null,payFeeTypeId:null,systemUserName:null,expireDays:null},o={payId:null,systemUserName:null,restaurantNo:null,restaurantName:null,payWay:null,payFeeType:null,payAmount:null,payTime:null,startDate:null,endDate:null,payStatus:null,payPersonName:null,restaurantId:null,principalName:null,phone:null,location:null,saleName:null,businessFullName:null,businessLicenseNo:"",payStartDate:Object(r.a)(),payEndDate:null,formDatePayTime:Object(r.a)(),payNote:"",bankName:"",account:""},n={no:"",name:""},s={payStartDate:[{required:!0,message:"请选择付费时间",trigger:"change"}],payEndDate:[{required:!0,message:"请选择到期时间",trigger:"change"}]},i={data:function(){return{total:0,searchForm:l,datatime:[],formData:Object(r.b)(o),dialogTableVisible:!1,detailFormData:n,payWayOptions:[],payFeeTypeOptions:[],activeValue:1,inactiveValue:0,addDialog:!1,rules:s,detailTableData:[],pickerOptions:r.g,tableData:[]}},mounted:function(){this.query(),this.queryPayFeeType()},methods:{resetForm:function(e){this.$refs[e].resetFields()},query:function(){var e=this,a=this.searchForm,t=this.datatime;if(t){var r=t[0],l=t[1];this.searchForm.startDate=r,this.searchForm.endDate=l}else this.searchForm.startDate=null,this.searchForm.endDate=null;var o=this.searchForm.expireDays;o&&(this.searchForm.expireDays=parseInt(o)),this.$axios.post("/payPlatformFee/listByConditions",a).then(function(a){var t=a.records;e.tableData=t,e.total=a.total}).catch(function(e){})},queryPayFeeType:function(){var e=this;this.$axios.post("/payMethod/getAllPayMethod").then(function(a){e.payWayOptions=a}).catch(function(e){})},handlePayFeeTypeChange:function(){var e=this.formData.payWay,a=this.payFeeTypeOptions.filter(function(a){return a.bonusName===e});a.length>0?this.formData.payAmount=a[0].bonusNumber:this.formData.payAmount=null},onAddClick:function(e){var a=this;this.formData=Object(r.b)(e),this.formData.payWay=null,this.formData.payAmount=null,this.formData.payStartDate=Object(r.a)(),this.formData.formDatePayTime=Object(r.a)(),this.addDialog=!0,this.$axios.post("/platformBonus/getPlatformBonus").then(function(e){a.payFeeTypeOptions=e}).catch(function(e){})},create:function(e){var a=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var t=a.formData,l=t.restaurantId,o=(t.payFeeType,t.payPersonName),n=t.payWay,s=t.payAmount,i=t.payStartDate,m=t.payEndDate,p=t.formDatePayTime,c=t.payStatus,u={rId:l,payFeeTypeId:t.payFeeTypeId,payPersonName:o,payWay:n,payAmount:s,payStartDate:i,payEndDate:m,payTime:p,payStatus:c,payPhone:t.phone,payNote:t.payNote};a.$axios.post("/payPlatformFee/addPayFee",u).then(function(e){0===e.code?(Object(r.e)(e.mes,{type:"success"}),a.addDialog=!1,a.query()):Object(r.e)(e.mes,{type:"error"})}).catch(function(e){})})},handleCurrentChange:function(e){this.searchForm.current=e,this.query()},handleStatusChange:function(e){var a=this,t=e.payId,l=e.payStatus;if(!t)return this.$notify.warning({title:"警告",message:"该商家未付费，请先付费！"}),void this.query();var o={payId:t,payStatus:l};this.$axios({method:"get",url:"/payPlatformFee/modifyState",params:o}).then(function(e){if(0===e.code)Object(r.e)("操作成功！",{type:"success"}),a.query();else{Object(r.e)("操作失败！",{type:"error"});var t=a.inactiveValue;a.inactiveValue=a.activeValue,a.activeValue=t,a.query()}}).catch(function(e){Object(r.e)("操作失败！",{type:"error"}),a.query()})},onDetailClick:function(e){var a=this;this.dialogTableVisible=!0;var t=e.restaurantNo,r=e.restaurantName,l=e.restaurantId;this.detailFormData={no:t,name:r},this.$axios({method:"get",url:"payPlatformFee/getAllPayMes?rId="+l}).then(function(e){a.detailTableData=e.records}).catch(function(e){})}}},m={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("div",{staticClass:"container"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"选择日期"}},[t("el-date-picker",{staticStyle:{width:"470px"},attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.datatime,callback:function(a){e.datatime=a},expression:"datatime"}})],1),t("br"),e._v(" "),t("el-form-item",{attrs:{label:"商家编号"}},[t("el-input",{attrs:{placeholder:"请输入商家编号"},model:{value:e.searchForm.restaurantNo,callback:function(a){e.$set(e.searchForm,"restaurantNo",a)},expression:"searchForm.restaurantNo"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商家名称"}},[t("el-input",{attrs:{placeholder:"请输入商家名称"},model:{value:e.searchForm.restaurantName,callback:function(a){e.$set(e.searchForm,"restaurantName",a)},expression:"searchForm.restaurantName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"业态状态"}},[t("el-input",{attrs:{placeholder:"请输入业态状态"},model:{value:e.searchForm.operateType,callback:function(a){e.$set(e.searchForm,"operateType",a)},expression:"searchForm.operateType"}})],1),t("br"),e._v(" "),t("el-form-item",{attrs:{label:"支付方式"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.searchForm.payFeeTypeId,callback:function(a){e.$set(e.searchForm,"payFeeTypeId",a)},expression:"searchForm.payFeeTypeId"}},e._l(e.payWayOptions,function(e){return t("el-option",{key:e.payId,attrs:{label:e.payName,value:e.payId}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"所属区域"}},[t("el-input",{attrs:{placeholder:"请输入所属区域"},model:{value:e.searchForm.restaurantAddress,callback:function(a){e.$set(e.searchForm,"restaurantAddress",a)},expression:"searchForm.restaurantAddress"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"管理人员"}},[t("el-input",{attrs:{placeholder:"请输入管理人员"},model:{value:e.searchForm.systemUserName,callback:function(a){e.$set(e.searchForm,"systemUserName",a)},expression:"searchForm.systemUserName"}})],1),t("br"),e._v(" "),t("el-form-item",{attrs:{label:"即将到期天数"}},[t("el-input",{attrs:{hasClear:"",placeholder:"请输入即将到期天数"},model:{value:e.searchForm.expireDays,callback:function(a){e.$set(e.searchForm,"expireDays",a)},expression:"searchForm.expireDays"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.query}},[e._v("查询")]),e._v(" "),t("el-button",{attrs:{type:"warning"},on:{click:e.query}},[e._v("导出")])],1)],1),e._v(" "),t("el-table",{ref:"multipleTable",attrs:{data:e.tableData,border:""}},[t("el-table-column",{attrs:{fixed:"",type:"index",label:"序号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.$index+10*(e.searchForm.current-1)+1))])]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"systemUserName",label:"管理人员",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"restaurantNo","min-width":"100px",label:"付费商家编号",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"restaurantName","min-width":"100px",label:"付费商家名称",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"payWay",label:"付费方式",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"payAmount",label:"付费金额",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"startDate","min-width":"100px",label:"付费开始时间",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"endDate","min-width":"100px",label:"付费到期时间",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-switch",{attrs:{"active-text":"使用中","active-value":e.activeValue,"inactive-value":e.inactiveValue,"inactive-text":"停止","active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(t){e.handleStatusChange(a.row)}},model:{value:a.row.payStatus,callback:function(t){e.$set(a.row,"payStatus",t)},expression:"scope.row.payStatus"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作",width:"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){e.onAddClick(a.row)}}},[e._v("增加\n          ")]),e._v(" "),t("el-button",{attrs:{type:"text"},on:{click:function(t){e.onDetailClick(a.row)}}},[e._v("详情\n          ")])]}}])})],1),e._v(" "),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.searchForm.current,lauut:"prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(a){e.$set(e.searchForm,"current",a)}}})],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"商家付费",visible:e.addDialog},on:{"update:visible":function(a){e.addDialog=a}}},[t("el-form",{ref:"formData",attrs:{model:e.formData,inline:!0,rules:e.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"商家编号：",prop:"restaurantNo"}},[t("el-input",{model:{value:e.formData.restaurantNo,callback:function(a){e.$set(e.formData,"restaurantNo",a)},expression:"formData.restaurantNo"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商家名称：",prop:"restaurantName"}},[t("el-input",{model:{value:e.formData.restaurantName,callback:function(a){e.$set(e.formData,"restaurantName",a)},expression:"formData.restaurantName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"支付方式:",prop:"payFeeTypeId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.formData.payFeeTypeId,callback:function(a){e.$set(e.formData,"payFeeTypeId",a)},expression:"formData.payFeeTypeId"}},e._l(e.payWayOptions,function(e){return t("el-option",{key:e.payId,attrs:{label:e.payName,value:e.payId}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"平台费用类型:",prop:"payWay"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},on:{change:e.handlePayFeeTypeChange},model:{value:e.formData.payWay,callback:function(a){e.$set(e.formData,"payWay",a)},expression:"formData.payWay"}},e._l(e.payFeeTypeOptions,function(e){return t("el-option",{key:e.bonusID,attrs:{label:e.bonusName,value:e.bonusName}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"付费金额",prop:"payAmount"}},[t("el-input",{model:{value:e.formData.payAmount,callback:function(a){e.$set(e.formData,"payAmount",a)},expression:"formData.payAmount"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"付费人",prop:"payPersonName"}},[t("el-input",{model:{value:e.formData.payPersonName,callback:function(a){e.$set(e.formData,"payPersonName",a)},expression:"formData.payPersonName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"开始时间",prop:"payStartDate"}},[t("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择开始时间"},model:{value:e.formData.payStartDate,callback:function(a){e.$set(e.formData,"payStartDate",a)},expression:"formData.payStartDate"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"到期时间",prop:"payEndDate"}},[t("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择到期时间"},model:{value:e.formData.payEndDate,callback:function(a){e.$set(e.formData,"payEndDate",a)},expression:"formData.payEndDate"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"付费时间",prop:"formDatePayTime"}},[t("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择付费时间"},model:{value:e.formData.formDatePayTime,callback:function(a){e.$set(e.formData,"formDatePayTime",a)},expression:"formData.formDatePayTime"}})],1),t("br"),e._v(" "),t("el-form-item",{attrs:{label:"开票名称：",prop:"businessFullName"}},[t("el-input",{attrs:{disabled:""},model:{value:e.formData.businessFullName,callback:function(a){e.$set(e.formData,"businessFullName",a)},expression:"formData.businessFullName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"税号：",prop:"businessLicenseNo"}},[t("el-input",{attrs:{disabled:""},model:{value:e.formData.businessLicenseNo,callback:function(a){e.$set(e.formData,"businessLicenseNo",a)},expression:"formData.businessLicenseNo"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"地址：",prop:"location"}},[t("el-input",{attrs:{disabled:""},model:{value:e.formData.location,callback:function(a){e.$set(e.formData,"location",a)},expression:"formData.location"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"电话：",prop:"phone"}},[t("el-input",{attrs:{disabled:""},model:{value:e.formData.phone,callback:function(a){e.$set(e.formData,"phone",a)},expression:"formData.phone"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"开户行：",prop:"bankName"}},[t("el-input",{attrs:{disabled:""},model:{value:e.formData.bankName,callback:function(a){e.$set(e.formData,"bankName",a)},expression:"formData.bankName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"账号：",prop:"account"}},[t("el-input",{attrs:{disabled:""},model:{value:e.formData.account,callback:function(a){e.$set(e.formData,"account",a)},expression:"formData.account"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"备注",prop:"payNote"}},[t("el-input",{model:{value:e.formData.payNote,callback:function(a){e.$set(e.formData,"payNote",a)},expression:"formData.payNote"}})],1),e._v(" "),t("br"),e._v(" "),t("el-form-item",{staticStyle:{"margin-left":"120px"}},[t("el-button",{attrs:{type:"primary"},on:{click:function(a){e.create("formData")}}},[e._v("确定")]),e._v(" "),t("el-button",{on:{click:function(a){e.resetForm()}}},[e._v("重置")])],1)],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"详情",visible:e.dialogTableVisible},on:{"update:visible":function(a){e.dialogTableVisible=a}}},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.detailFormData}},[t("el-form-item",{attrs:{label:"商家编号:",prop:"no"}},[t("el-input",{attrs:{disabled:""},model:{value:e.detailFormData.no,callback:function(a){e.$set(e.detailFormData,"no",a)},expression:"detailFormData.no"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商家名称:",prop:"name"}},[t("el-input",{attrs:{disabled:""},model:{value:e.detailFormData.name,callback:function(a){e.$set(e.detailFormData,"name",a)},expression:"detailFormData.name"}})],1)],1),e._v(" "),t("el-table",{attrs:{data:e.detailTableData}},[t("el-table-column",{attrs:{width:"50",type:"index",label:"序号",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{property:"payTime",label:"付费日期"}}),e._v(" "),t("el-table-column",{attrs:{property:"no",label:"商家编号"}}),e._v(" "),t("el-table-column",{attrs:{property:"payStartDate",label:"开始日期"}}),e._v(" "),t("el-table-column",{attrs:{property:"payEndDate",label:"结束日期"}}),e._v(" "),t("el-table-column",{attrs:{property:"payAmount",label:"付费金额"}}),e._v(" "),t("el-table-column",{attrs:{property:"payName",label:"付费方式"}})],1)],1)],1)},staticRenderFns:[]};var p=t("VU/8")(i,m,!1,function(e){t("OkEb")},"data-v-1f9cf99e",null);a.default=p.exports},OkEb:function(e,a){}});