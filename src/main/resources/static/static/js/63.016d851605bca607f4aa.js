webpackJsonp([63],{"6uvQ":function(e,t){},e95W:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=o("Dd8w"),r=o.n(l),i={data:function(){return{addDialog:!1,delVisible:!1,editDialog:!1,preeDialog:!1,formInline:{roleNo:"",name:"",current:1},setRoleForm:{},total:0,addRoleForm:{roleNo:"",name:"",description:""},roleForm:{},tableData:[],rules:{roleNo:[{required:!0,message:"请输入角色编号",trigger:"blur"}],name:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},permissionTree:[],defaultProps:{children:"children",label:"label"}}},created:function(){this.getRoles(),this.getPermissioms()},methods:{getPermissioms:function(){var e=this;this.$axios.get("/permission/listTree").then(function(t){e.permissionTree=t.result}).catch(function(e){console.log("error",e)})},getRoles:function(){var e=this;this.$axios.get("/role/listAndPermission",{params:this.formInline}).then(function(t){var o=t.records.map(function(e){var t=[],o=[];return e.permissions.forEach(function(e){t.push(e.permissionId),o.push(e.permissionNode)}),t=t.join(","),o=o.join(","),r()({ids:t,names:o},e)});e.tableData=o,e.total=t.total})},queryRole:function(){this.getRoles()},submitForm:function(e){var t=this;"setRoleForm"!==e?this.$refs[e].validate(function(o){if(o){var l={};"roleForm"===e?(delete(l=t.roleForm).ids,delete l.names,delete l.permissions):l=t.addRoleForm,console.log(l),t.$axios.get("/role/add",{params:l}).then(function(o){t.$message({message:"roleForm"===e?"修改成功":"新增成功",type:"success"}),t.editDialog=!1,t.addDialog=!1,t.getRoles()})}}):this.$axios.get("/permission/bindPermission",{params:{roleId:this.setRoleForm.roleId,permissionIds:this.$refs.tree.getCheckedKeys().join(",")}}).then(function(e){t.$message({message:"授权成功",type:"success"}),t.preeDialog=!1,t.getRoles()})},resetForm:function(e){this.$refs[e].resetFields()},handleAddPermission:function(e,t){var o=this;this.setRoleForm=t,this.preeDialog=!0,setTimeout(function(){o.$refs.tree.setCheckedKeys(t.ids.split(","))},200)},handleAdd:function(){this.addDialog=!0},handleEdit:function(e,t){this.idx=e,this.roleForm=t,this.editDialog=!0},handleDelete:function(e,t){this.idx=e,this.row=t,this.delVisible=!0},deleteRow:function(){var e=this;this.$axios.get("/role/delete",{params:{roleId:this.row.roleId}}).then(function(t){e.tableData.splice(e.idx,1),e.$message.success("删除成功"),e.delVisible=!1})},handleCurrentChange:function(e){this.formInline.current=e,this.getOperateTypes()}}},n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"container"},[o("div",{staticClass:"handle-box"},[o("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[o("el-form-item",{attrs:{label:"角色编号"}},[o("el-input",{attrs:{placeholder:"请输入角色编号"},model:{value:e.formInline.roleNo,callback:function(t){e.$set(e.formInline,"roleNo",t)},expression:"formInline.roleNo"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"角色名称"}},[o("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.queryRole}},[e._v("查询")])],1),e._v(" "),o("el-button",{staticClass:"handle-del mr10 right",attrs:{type:"primary",icon:"add"},on:{click:e.handleAdd}},[e._v("增加")])],1)],1),e._v(" "),o("el-table",{staticClass:"table",attrs:{data:e.tableData,border:""}},[o("el-table-column",{attrs:{width:"50",type:"index",label:"序号",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"roleNo",label:"角色编号",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"ids",label:"权限编号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.ids.length>50?t.row.ids.substring(0,50)+"...":t.row.ids))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"names",label:"权限名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.names.length>25?t.row.names.substring(0,25)+"...":t.row.names))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"角色名称",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"description",label:"角色描述",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("删除")]),e._v(" "),o("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("修改")]),e._v(" "),o("el-button",{staticClass:"warning",attrs:{type:"text",icon:"el-icon-setting"},on:{click:function(o){e.handleAddPermission(t.$index,t.row)}}},[e._v("授权")])]}}])})],1),e._v(" "),o("div",{staticClass:"pagination"},[o("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),o("el-dialog",{attrs:{title:"增加角色",width:"400px",visible:e.addDialog},on:{close:function(t){e.resetForm("addRoleForm")},"update:visible":function(t){e.addDialog=t}}},[o("el-form",{ref:"addRoleForm",attrs:{model:e.addRoleForm,rules:e.rules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"角色编号",prop:"roleNo"}},[o("el-input",{model:{value:e.addRoleForm.roleNo,callback:function(t){e.$set(e.addRoleForm,"roleNo",t)},expression:"addRoleForm.roleNo"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[o("el-input",{model:{value:e.addRoleForm.name,callback:function(t){e.$set(e.addRoleForm,"name",t)},expression:"addRoleForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"描述"}},[o("el-input",{model:{value:e.addRoleForm.description,callback:function(t){e.$set(e.addRoleForm,"description",t)},expression:"addRoleForm.description"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("addRoleForm")}}},[e._v("确定")]),e._v(" "),o("el-button",{on:{click:function(t){e.resetForm("addRoleForm")}}},[e._v("重置")])],1)],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"角色授权",width:"400px",visible:e.preeDialog},on:{close:function(t){e.resetForm("setRoleForm")},"update:visible":function(t){e.preeDialog=t}}},[o("el-form",{ref:"setRoleForm",attrs:{model:e.setRoleForm,rules:e.rules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"角色编号",prop:"roleNo"}},[o("el-input",{attrs:{readonly:""},model:{value:e.setRoleForm.roleNo,callback:function(t){e.$set(e.setRoleForm,"roleNo",t)},expression:"setRoleForm.roleNo"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[o("el-input",{attrs:{readonly:""},model:{value:e.setRoleForm.name,callback:function(t){e.$set(e.setRoleForm,"name",t)},expression:"setRoleForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"权限编号"}},[o("el-tree",{ref:"tree",attrs:{data:e.permissionTree,"show-checkbox":"","node-key":"id","highlight-current":"",props:e.defaultProps}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("setRoleForm")}}},[e._v("确定")]),e._v(" "),o("el-button",{on:{click:function(t){e.resetForm("setRoleForm")}}},[e._v("重置")])],1)],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"角色修改",width:"400px",visible:e.editDialog},on:{close:function(t){e.resetForm("roleForm")},"update:visible":function(t){e.editDialog=t}}},[o("el-form",{ref:"roleForm",attrs:{model:e.roleForm,rules:e.rules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"角色编号",prop:"roleNo"}},[o("el-input",{model:{value:e.roleForm.roleNo,callback:function(t){e.$set(e.roleForm,"roleNo",t)},expression:"roleForm.roleNo"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[o("el-input",{model:{value:e.roleForm.name,callback:function(t){e.$set(e.roleForm,"name",t)},expression:"roleForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"描述",prop:"description"}},[o("el-input",{model:{value:e.roleForm.description,callback:function(t){e.$set(e.roleForm,"description",t)},expression:"roleForm.description"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("roleForm")}}},[e._v("确定")]),e._v(" "),o("el-button",{on:{click:function(t){e.resetForm("roleForm")}}},[e._v("重置")])],1)],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"提示",visible:e.delVisible,width:"300px",center:""},on:{"update:visible":function(t){e.delVisible=t}}},[o("div",{staticClass:"del-dialog-cnt"},[e._v("删除不可恢复，是否确定删除？")]),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.delVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.deleteRow}},[e._v("确 定")])],1)])],1)])},staticRenderFns:[]};var s=o("VU/8")(i,n,!1,function(e){o("6uvQ")},"data-v-0a1a108c",null);t.default=s.exports}});