webpackJsonp([55],{NHW7:function(e,t){},V55V:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("ZoQJ"),l={userName:[{required:!0,message:"人员名称不能为空",trigger:"blur"}],userTelephone:[{required:!0,message:"电话号码不能为空",trigger:"blur"}],userPassword:[{required:!0,message:"密码不能为空",trigger:"blur"}]},n={userType:null,userName:null,userStatus:null,userTelephone:null,userPassword:null,userNote:null},o=[{label:"不可用",value:0},{label:"可用",value:1}],s=[{label:"管理员",value:0},{label:"操作员",value:3}],i={data:function(){return{statusOptions:o,userTypeOptions:s,rules:l,dialogTitleMap:{update:"修改",create:"新增"},currentDialogVisible:!1,dialogStatus:"create",formData:Object(r.b)(n),merchantNo:"系统用户",merchantName:"系统用户",merchantOptions:[],selectedMerchant:"",dialogVisible:!1,total:1,tableData:[],formInline:{rId:null,current:1}}},mounted:function(){"2"===localStorage.userType&&(this.initMerchantData(),this.query())},methods:{initMerchantData:function(){var e=localStorage,t=e.merchant_no,a=e.merchant_name,r=e.selectedShop;this.merchantNo=t,this.merchantName=a,this.formInline.rId=r},query:function(){var e=this;this.$axios({methods:"get",url:"/userInfo/listOperators",params:this.formInline}).then(function(t){e.tableData=t.records,e.total=t.total}).catch(function(e){})},onSelectedMerchantClick:function(){var e=this;this.$axios.get("/restaurantInfo/getResByWx").then(function(t){e.merchantOptions=t.res,t.res.length>1?e.dialogVisible=!0:Object(r.d)("当前账号只绑定一个商家！",{type:"warning"})}).catch(function(e){console.log(e)})},handleConfirmLogin:function(){var e=this.selectedMerchant,t=this.merchantOptions;if(e){for(var a=window.localStorage,r=0;r<t.length;r++){var l=t[r];l.id===parseInt(e)&&(a.merchant_name=l.name,a.merchant_no=l.no)}a.selectedShop=e,this.initMerchantData(),location.reload()}},onAddClick:function(e){this.dialogStatus=e,this.currentDialogVisible=!0},handleAdd:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var a=localStorage.selectedShop;t.$axios.post("/userInfo/addOperatorByRId/"+a,t.formData).then(function(e){0===e.code?(Object(r.d)(e.mes,{type:"success"}),t.currentDialogVisible=!1,t.query()):Object(r.d)(e.mes,{type:"error"})}).catch(function(e){console.log("error",e)})})},onUpdateClick:function(e,t){this.dialogStatus=e,this.formData=Object(r.b)(t),this.currentDialogVisible=!0},handleUpdate:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.$axios.post("/userInfo/updateOperator",t.formData).then(function(e){0===e.code?(Object(r.d)(e.mes,{type:"success"}),t.currentDialogVisible=!1,t.query()):Object(r.d)(e.mes,{type:"error"})}).catch(function(e){console.log("error",e)})})},onDeleteClick:function(e){var t=this;this.$confirm("确定删除此信息吗？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"error"}).then(function(){var a=localStorage.selectedShop,l={userId:e.userID,rId:a};t.$axios({url:"/userInfo/deleteOperator",methods:"get",params:l}).then(function(e){e?(Object(r.d)("删除成功！",{type:"success"}),t.query()):Object(r.d)("删除失败！",{type:"error"})}).catch(function(e){console.log("error",e)})}).catch(function(){})},handleCurrentChange:function(e){this.formInline.current=e,this.query()}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"商家编号"}},[e._v(e._s(e.merchantNo))]),e._v(" "),a("el-form-item",{attrs:{label:"商家名称"}},[e._v(e._s(e.merchantName))]),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSelectedMerchantClick}},[e._v("切换商家")])],1)],1),e._v(" "),a("hr",{staticStyle:{"margin-bottom":"20px"}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.query()}}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onAddClick("create")}}},[e._v("添加")])],1),e._v(" "),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{width:50,fixed:"",type:"index",label:"序号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.$index+10*(e.formInline.current-1)+1))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"人员名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userStatus",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(0===t.row.userStatus?"不可用":1===t.row.userStatus?"可用":"")+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"wxOpenId",label:"OpenID",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userPassword",label:"密码",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userTelephone",label:"电话",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userType",label:"类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(0===t.row.userType?"管理员":3===t.row.userType?"操作员":"")+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){e.onUpdateClick("update",t.row)}}},[a("i",{staticClass:"el-icon-edit"},[e._v("修改")])]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.onDeleteClick(t.row)}}},[a("i",{staticClass:"el-icon-delete"},[e._v("删除")])])]}}])})],1),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.formInline.current,layout:"prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.formInline,"current",t)}}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogTitleMap[e.dialogStatus],visible:e.currentDialogVisible},on:{"update:visible":function(t){e.currentDialogVisible=t}}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:22}},[a("el-form",{ref:"formData",attrs:{model:e.formData,rules:e.rules,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"人员名称:",prop:"userName"}},[a("el-input",{model:{value:e.formData.userName,callback:function(t){e.$set(e.formData,"userName",t)},expression:"formData.userName"}}),a("br")],1),e._v(" "),a("el-form-item",{attrs:{label:"状态:",prop:"userStatus"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formData.userStatus,callback:function(t){e.$set(e.formData,"userStatus",t)},expression:"formData.userStatus"}},e._l(e.statusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"电话:",prop:"userTelephone"}},[a("el-input",{model:{value:e.formData.userTelephone,callback:function(t){e.$set(e.formData,"userTelephone",t)},expression:"formData.userTelephone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码:",prop:"userPassword"}},[a("el-input",{model:{value:e.formData.userPassword,callback:function(t){e.$set(e.formData,"userPassword",t)},expression:"formData.userPassword"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"人员类型:",prop:"userType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formData.userType,callback:function(t){e.$set(e.formData,"userType",t)},expression:"formData.userType"}},e._l(e.userTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{staticStyle:{"margin-left":"120px"}},[a("el-button",{on:{click:function(t){e.currentDialogVisible=!1}}},[e._v("取消")]),e._v(" "),"create"==e.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleAdd("formData")}}},[e._v("确定")]):a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleUpdate("formData")}}},[e._v("确定")])],1)],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"店铺选择",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-select",{attrs:{placeholder:"请选择您要切换的店铺"},model:{value:e.selectedMerchant,callback:function(t){e.selectedMerchant=t},expression:"selectedMerchant"}},e._l(e.merchantOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirmLogin}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var u=a("VU/8")(i,c,!1,function(e){a("NHW7")},"data-v-1d07aa56",null);t.default=u.exports}});