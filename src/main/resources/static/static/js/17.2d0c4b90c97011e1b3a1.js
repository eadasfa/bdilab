webpackJsonp([17],{"2t3h":function(e,t,a){"use strict";function l(e){a("vmoR")}Object.defineProperty(t,"__esModule",{value:!0});var r=a("DKvN"),n=a("oEVg"),i=a("VU/8"),o=l,c=i(r.a,n.a,o,"data-v-4037984b",null);t.default=c.exports},"3Zkn":function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".el-tabs[data-v-4037984b]{min-height:400px}.el-card[data-v-4037984b]{min-height:400px;min-width:240px}",""])},DKvN:function(e,t,a){"use strict";var l=a("Dd8w"),r=a.n(l),n=a("NYxO"),i=a("0xDb"),o=[{orderNum:"1",fullBridgeRating:"一类",number:0,total:0,percentage:0,children:[]},{orderNum:"2",fullBridgeRating:"二类",number:0,total:0,percentage:0,children:[]},{orderNum:"3",fullBridgeRating:"三类",number:0,total:0,percentage:0,children:[]},{orderNum:"4",fullBridgeRating:"四类",number:0,total:0,percentage:0,children:[]},{orderNum:"5",fullBridgeRating:"五类",number:0,total:0,percentage:0,children:[]}],c={page:0,size:999,projection:"statistic",projectIds:[]};t.a={data:function(){return{loading:!1,activeTab:"summaryTable",IsAllSelect:!0,searchForm:a.i(i.c)(c),tableData:[],detailTableData:[],detailTableRowList:[]}},computed:r()({},a.i(n.b)(["bridgesStatistic","menus"])),methods:r()({},a.i(n.c)(["queryAllBridgesForStatistic"]),{query:function(e){var t=this;this.loading=!0;var a=this.searchForm.projectIds,l=a.map(function(e){return{id:e}});this.queryAllBridgesForStatistic(l).then(function(){t.loading=!1,"function"==typeof e&&e()}).catch(function(e){console.log(e),t.loading=!1})},handleAllSelected:function(){this.searchForm.projectIds=[];var e=[];this.menus.forEach(function(t){e.push(t.id)}),this.searchForm.projectIds=e,this.IsAllSelect=!1},handleDelAllSelected:function(){this.searchForm.projectIds=[],this.IsAllSelect=!0},handleSearch:function(){var e=this;this.query(function(){e.generateTableData(),e.createDetailsTableData()})},generateTableData:function(){var e=this,t=this.bridgesStatistic;this.tableData=a.i(i.c)(o);var l=0;t.forEach(function(t){var a=t.bridgeNo,r=t.bridgeName,n=t.administrativeIdentification,i=t.structuralTechnology,o=t.periodInspection,c=i.bridgeLength,s=n.routeName,u=o.superStructureRate,d=o.lowerStructureRate,p=o.bridgeSurfaceRate,b=o.overallRate,h=o.fullBridgeRating,m={bridgeNo:a,bridgeName:r,routeName:s,bridgeLength:c,superStructureRate:u,lowerStructureRate:d,bridgeSurfaceRate:p,overallRate:b};if(h){var g=parseInt(h);e.tableData[g-1].children.push(m),l+=1}}),this.tableData.forEach(function(e){var t=e.children.length;e.total=l,e.number=t,e.percentage=(l?(100*t/l).toFixed(2):0)+"%"})},spanSummaryTable:function(e){var t=(e.row,e.column,e.rowIndex);if(3===e.columnIndex)return 0===t?[5,1]:[0,0]},createDetailsTableData:function(){var e=this;this.detailTableData=[],this.tableData.forEach(function(t){var a,l=t.fullBridgeRating,n=t.children,i=[];n.forEach(function(e,t){var a=r()({},e,{orderNum:t+1,fullBridgeRating:l});i.push(a)}),i.length||i.push({orderNum:1,fullBridgeRating:l,bridgeNo:"/",bridgeName:"/",routeName:"/",bridgeLength:"/",superStructureRate:"/",lowerStructureRate:"/",bridgeSurfaceRate:"/",overallRate:"/"}),(a=e.detailTableData).push.apply(a,i),e.detailTableRowList.push(i.length)})},spanDetailTable:function(e){var t=(e.row,e.column,e.rowIndex);if(0===e.columnIndex)return a.i(i.k)(t,this.detailTableRowList)},handleExportTotalTable:function(){var e=this;this.$confirm("您确定要导出Excel吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(function(){e.exportTotalTable(),a.i(i.d)("已成功导出Excel!",{type:"success"})}).catch(function(){a.i(i.d)("已取消!",{type:"info"})})},exportTotalTable:function(){var e=this;Promise.all([a.e(36),a.e(35)]).then(function(){var t=a("zWO4"),l=t.export_json_to_excel,r=["序号","评定等级","数量","桥梁总数","百分比"],n=["id","fullBridgeRating","number","total","percentage"];l(r,a.i(i.h)(n,e.tableData),"桥梁技术状况统计总表")}.bind(null,a)).catch(a.oe)},handleExportDetailTable:function(){var e=this;this.$confirm("您确定要导出Excel吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(function(){e.exportDetailTable(),a.i(i.d)("已成功导出Excel!",{type:"success"})}).catch(function(){a.i(i.d)("已取消!",{type:"info"})})},exportDetailTable:function(){var e=this;Promise.all([a.e(36),a.e(35)]).then(function(){var t=a("zWO4"),l=t.export_json_to_excel,r=["评定等级","序号","桥梁名称","桥梁编号","桥梁长度","线路名称","上部评定等级","下部评定等级","桥面系评定等级","技术评分"],n=["fullBridgeRating","id","bridgeName","bridgeNo","bridgeLength","routeName","superStructureRate","lowerStructureRate","bridgeSurfaceRate","overallRate"];l(r,a.i(i.h)(n,e.detailTableData),"桥梁技术状况统计样表")}.bind(null,a)).catch(a.oe)}})}},oEVg:function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"桥梁技术状况统计总表",name:"summaryTable"}},[a("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:24}},[a("el-col",{attrs:{span:10}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",multiple:"",placeholder:"选择项目（可多选）"},model:{value:e.searchForm.projectIds,callback:function(t){e.$set(e.searchForm,"projectIds",t)},expression:"searchForm.projectIds"}},e._l(e.menus,function(e){return a("el-option",{key:e.id,attrs:{label:e.projectName,value:e.id}})}))],1),e._v(" "),a("el-col",{attrs:{span:1}},[e.IsAllSelect?a("el-button",{attrs:{type:"text"},on:{click:e.handleAllSelected}},[e._v("全选")]):a("el-button",{attrs:{type:"text"},on:{click:e.handleDelAllSelected}},[e._v("取消全选")])],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{icon:"el-icon-search",loading:e.loading,type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{type:"warning",icon:"el-icon-download"},on:{click:e.handleExportTotalTable}},[e._v("导出excel")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"span-method":e.spanSummaryTable,border:""}},[a("el-table-column",{attrs:{label:"序号",width:"70",align:"center",type:"index"}}),e._v(" "),a("el-table-column",{attrs:{prop:"fullBridgeRating",label:"评定等级","min-width":"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"number",label:"数量","min-width":"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total",label:"桥梁总数","min-width":"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"percentage",label:"百分比","min-width":"100",align:"center"}})],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"桥梁技术状况统计样表",name:"detailTable"}},[a("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:24}},[a("el-col",{attrs:{span:10}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",multiple:""},model:{value:e.searchForm.projectIds,callback:function(t){e.$set(e.searchForm,"projectIds",t)},expression:"searchForm.projectIds"}},e._l(e.menus,function(e){return a("el-option",{key:e.id,attrs:{label:e.projectName,value:e.id}})}))],1),e._v(" "),a("el-col",{attrs:{span:1}},[e.IsAllSelect?a("el-button",{attrs:{type:"text"},on:{click:e.handleAllSelected}},[e._v("全选")]):a("el-button",{attrs:{type:"text"},on:{click:e.handleDelAllSelected}},[e._v("取消全选")])],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{icon:"el-icon-search",loading:e.loading,type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{type:"warning",icon:"el-icon-download"},on:{click:e.handleExportDetailTable}},[e._v("导出excel")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.detailTableData,"span-method":e.spanDetailTable,border:""}},[a("el-table-column",{attrs:{prop:"fullBridgeRating",label:"评定等级",width:"60",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"orderNum",label:"序号",width:"50",align:"center",type:"index"}}),e._v(" "),a("el-table-column",{attrs:{prop:"bridgeName",label:"桥梁名称","min-width":"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"bridgeNo",label:"桥梁编码","min-width":"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"bridgeLength",label:"桥梁长度",width:"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"routeName",label:"线路名称","min-width":"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"superStructureRate",label:"上部评定等级","min-width":"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"lowerStructureRate",label:"下部评定等级","min-width":"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"bridgeSurfaceRate",label:"桥面系评定等级","min-width":"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"overallRate",label:"总体技术状况评分","min-width":"80",align:"center"}})],1)],1)],1)],1)},r=[],n={render:l,staticRenderFns:r};t.a=n},vmoR:function(e,t,a){var l=a("3Zkn");"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);a("rjj0")("61250282",l,!0)}});