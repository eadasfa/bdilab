webpackJsonp([24],{HSDE:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,".bmap-view[data-v-c092df8e]{width:60%;min-height:400px;max-height:500px}.el-form-item[data-v-c092df8e]{margin-bottom:5px}",""])},PQS6:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{display:"flex"}},[a("baidu-map",{staticClass:"bmap-view",attrs:{center:t.mapConfig.center,zoom:t.mapConfig.zoom,"scroll-wheel-zoom":!0},on:{ready:t.onMapReady}},[a("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_TOP_LEFT"}}),t._v(" "),a("bm-map-type",{attrs:{"map-types":["BMAP_NORMAL_MAP","BMAP_HYBRID_MAP"],anchor:"BMAP_ANCHOR_TOP_RIGHT"}}),t._v(" "),a("bm-copyright",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_RIGHT",copyright:[{id:1,content:"",bounds:{ne:{lng:110,lat:40},sw:{lng:0,lat:0}}},{id:2,content:"<a target=_blank href=http://www.ccruitong.com/>中交瑞通路桥养护科技有限公司</a>"}]}}),t._v(" "),a("bm-marker",{attrs:{position:t.markerPoint,dragging:!1},on:{click:function(e){t.showInfoWindow=!0}}},[a("bm-info-window",{attrs:{show:t.showInfoWindow},on:{close:function(e){t.showInfoWindow=!1},open:function(e){t.showInfoWindow=!0}}},[a("p",[t._v("桥梁名称："+t._s(t.formData.bridgeName))]),t._v(" "),a("p",[t._v("桥梁编号："+t._s(t.formData.bridgeNo))]),t._v(" "),a("p",[t._v("桥梁位置："+t._s(t.formData.bridgeLocation))]),t._v(" "),a("p",[t._v("桥梁坐标："+t._s(t.formData.bridgeLat)+","+t._s(t.formData.bridgeLng))]),t._v(" "),t.formData.bridge3DPhoto?a("div",[a("p",[t._v("桥梁立面照片：")]),t._v(" "),a("img",{attrs:{src:"/api/resource/download/"+t.formData.bridge3DPhoto,width:"100"}})]):t._e(),t._v(" "),t.formData.bridgeFlatPhoto?a("div",[a("p",[t._v("桥梁平面照片：")]),t._v(" "),a("img",{attrs:{src:"/api/resource/download/"+t.formData.bridgeFlatPhoto,width:"100"}})]):t._e(),t._v(" "),t.formData.bridgeLayoutPhoto?a("div",[a("p",[t._v("桥型布置图：")]),t._v(" "),a("img",{attrs:{src:"/api/resource/download/"+t.formData.bridgeLayoutPhoto,width:"100"}})]):t._e()])],1)],1),t._v(" "),a("div",{staticStyle:{margin:"1px"}},[a("el-form",{staticStyle:{margin:"10px 10px"},attrs:{"label-position":t.labelPosition,"label-width":"110px",model:t.formData}},[a("el-form-item",{attrs:{label:"桥梁名称"}},[a("el-input",{attrs:{type:"text",size:"small"},model:{value:t.formData.bridgeName,callback:function(e){t.$set(t.formData,"bridgeName",e)},expression:"formData.bridgeName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"桥梁编号"}},[a("el-input",{attrs:{type:"text",size:"small"},model:{value:t.formData.bridgeNo,callback:function(e){t.$set(t.formData,"bridgeNo",e)},expression:"formData.bridgeNo"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"桥梁位置"}},[a("el-input",{attrs:{type:"text",size:"small"},model:{value:t.formData.bridgeLocation,callback:function(e){t.$set(t.formData,"bridgeLocation",e)},expression:"formData.bridgeLocation"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"桥梁地理位置"}},[a("el-form-item",{attrs:{label:"经度"}},[a("el-input",{attrs:{type:"text",size:"small"},model:{value:t.formData.bridgeLat,callback:function(e){t.$set(t.formData,"bridgeLat",e)},expression:"formData.bridgeLat"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"纬度"}},[a("el-input",{attrs:{type:"text",size:"small"},model:{value:t.formData.bridgeLng,callback:function(e){t.$set(t.formData,"bridgeLng",e)},expression:"formData.bridgeLng"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"桥型立面照片"}},[t.formData.bridge3DPhoto?a("img",{attrs:{src:"/api/resource/download/"+t.formData.bridge3DPhoto,width:"200"}}):t._e(),t._v(" "),t.formData.bridge3DPhoto?t._e():a("el-upload",{staticClass:"upload-demo",attrs:{action:"/api/resource/upload","on-success":t.handleUploadSuccess3D,"list-type":"picture","file-list":t.fileList3D}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("上传照片")])],1),a("br"),t._v(" "),t.formData.bridge3DPhoto?a("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(e){t.handleDeletePhoto("bridge3DPhoto")}}},[t._v("删除照片")]):t._e()],1),t._v(" "),a("el-form-item",{attrs:{label:"桥型平面照片"}},[t.formData.bridgeFlatPhoto?a("img",{attrs:{src:"/api/resource/download/"+t.formData.bridgeFlatPhoto,width:"200"}}):t._e(),t._v(" "),t.formData.bridgeFlatPhoto?t._e():a("el-upload",{staticClass:"upload-demo",attrs:{action:"/api/resource/upload","on-success":t.handleUploadSuccessFlat,"list-type":"picture","file-list":t.fileListFlat}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("上传照片")])],1),a("br"),t._v(" "),t.formData.bridgeFlatPhoto?a("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(e){t.handleDeletePhoto("bridgeFlatPhoto")}}},[t._v("删除照片")]):t._e()],1),t._v(" "),a("el-form-item",{attrs:{label:"桥型布置图"}},[t.formData.bridgeLayoutPhoto?a("img",{attrs:{src:"/api/resource/download/"+t.formData.bridgeLayoutPhoto,width:"200"}}):t._e(),t._v(" "),t.formData.bridgeLayoutPhoto?t._e():a("el-upload",{staticClass:"upload-demo",attrs:{action:"/api/resource/upload","on-success":t.handleUploadSuccessLayout,"list-type":"picture","file-list":t.fileListLayout}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("上传照片")])],1),a("br"),t._v(" "),t.formData.bridgeLayoutPhoto?a("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(e){t.handleDeletePhoto("bridgeLayoutPhoto")}}},[t._v("删除照片")]):t._e()],1),t._v(" "),a("el-form-item",{attrs:{label:"桥梁概况"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.formData.bridgeOverview,callback:function(e){t.$set(t.formData,"bridgeOverview",e)},expression:"formData.bridgeOverview"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.onSaveClick}},[t._v("保存")]),t._v(" "),a("el-button",{on:{click:t.onCancelClick}},[t._v("取消")])],1)],1)],1)],1)},i=[],r={render:o,staticRenderFns:i};e.a=r},gbQH:function(t,e,a){"use strict";var o=a("Dd8w"),i=a.n(o),r=a("NYxO"),n=a("0xDb");e.a={data:function(){return{show:!1,fileListFlat:[],fileList3D:[],fileListLayout:[],mapConfig:{center:{lng:0,lat:0},zoom:5},markerPoint:{lng:0,lat:0},showInfoWindow:!1,labelPosition:"right",formData:{id:0,bridgeName:"",bridgeNo:"",lng:0,lat:0,bridge3DPhoto:"",bridgeFlatPhoto:"",bridgeLayoutPhoto:"",bridgeOverview:"",bridgeLng:0,bridgeLat:0}}},mounted:function(){if(!this.$route.query.id&&!this.selectedBridge.id)return void a.i(n.d)("未选择桥梁，无法进行操作！",{type:"error"});var t=this.selectedBridge;t.id&&(this.bridge=t),this.onCancelClick()},watch:{bridges:function(){this.formData.id||this.onCancelClick()},menus:function(){var t=this,e=this.bridge;if(e&&!e.id){var a=this.$route.query.id;this.menus.forEach(function(e){var o=e.children.filter(function(t){return t.id===parseInt(a)});o.length&&(t.bridge=o[0],t.selectBridge(t.bridge))})}}},computed:i()({},a.i(r.b)(["selectedBridge","bridges","menus"])),methods:i()({},a.i(r.c)(["queryAllBridges","updateBridge"]),{handleRemove:function(t,e){console.log(t,e)},handleUploadSuccess3D:function(t,e,a){t&&t.length&&(this.formData.bridge3DPhoto=t[0],this.onSaveClick())},handleUploadSuccessFlat:function(t,e,a){t&&t.length&&(this.formData.bridgeFlatPhoto=t[0],this.onSaveClick())},handleUploadSuccessLayout:function(t,e,a){t&&t.length&&(this.formData.bridgeLayoutPhoto=t[0],this.onSaveClick())},handleDeletePhoto:function(t){var e=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=e.formData[t];if(a){var o="/api/resource/delete/"+a;fetch({url:o,method:"delete"}),e.formData[""+t]="",e.onSaveClick()}}).then(function(){e.formData[""+t]=""}).catch(function(){a.i(n.d)("已取消删除",{type:"info"})})},onMapReady:function(t){t.BMap,t.map;this.resetMapCenter()},resetMapCenter:function(){var t=this.formData,e=t.bridgeLng,a=t.bridgeLat;this.mapConfig.center.lng=a,this.mapConfig.center.lat=e,this.markerPoint.lng=a,this.markerPoint.lat=e},onSaveClick:function(){var t=this;this.updateBridge(this.formData).then(function(){return a.i(n.d)(),t.queryAllBridges({projection:"project-inline"})}).then(function(){}).catch(function(t){})},onCancelClick:function(){if(this.selectedBridge.id)this.formData=a.i(n.l)(this.selectedBridge);else{var t=this.$route.query.id,e=this.bridges.filter(function(e){return e.id===parseInt(t)});e.length&&(this.formData=a.i(n.l)(e[0]))}this.resetMapCenter()}})}},inrp:function(t,e,a){"use strict";function o(t){a("xciE")}Object.defineProperty(e,"__esModule",{value:!0});var i=a("gbQH"),r=a("PQS6"),n=a("VU/8"),l=o,s=n(i.a,r.a,l,"data-v-c092df8e",null);e.default=s.exports},xciE:function(t,e,a){var o=a("HSDE");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("c776b774",o,!0)}});